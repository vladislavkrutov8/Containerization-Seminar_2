# Containerization-Seminar_2

1) запустить контейнер с ubuntu, используя механизм LXC
2) ограничить контейнер 256 Мб ОЗУ и проверить, что ограничение работает
Задание по желанию ..
4)'' добавить автозапуск контейнеру, перезагрузить ОС и убедиться, что контейнер действительно запустился самостоятельно
5) ''при создании указать файл, куда записывать логи
6) ''после перезагрузки проанализировать логи

Начинааем установку  LXC и шаблонов: 

    sudo apt install lxc lxc-templates uidmap

Затем проверяем уствновленную версию командой "$ lxc version" . Система выдает подсказку, что для начала необходимо инициализировать LXD на машине. Вводим команду:

    lxd init
    
После инициализации снова убеждаемся, что все нормально установлено, путем проверки версии LXC:

    lxc version
    
![Screenshot_1](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/bf931715-b233-4036-9cbb-269bb7690520)

Затем создаем новый контейнер с именем testOne и задаем путь для файла конфигурации:

    lxc-create -n testOne -t ubuntu -f /usr/share/doc/lxc/lxc-veth.conf 
    
Видим большое количество текста, значит команда введена корректно. В тексте указана ошибка открытия файла конфигурации указанного нами. 

![Screenshot_2](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/0ed14633-c16f-4047-9d42-205a89895281)

Затем еобходимо запустить созданный нами контейнер. Для этого вводим следующую команду:

    sudo lxc-start -d -n testOne
    
![Screenshot_3](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/51da0f4a-e44c-4bba-bccc-274a006e240b)


Вводим следующую команду для просмотра выделенной и свободной памяти:

    free -m

![Screenshot_4](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/481f2795-79e3-4a2f-a934-b27c937e1fb5)

Считываем данные из файла, в котором уграничивается потребление памяти контейнером.
Здесь мы можем наблюдать, что ограничение памяти установлено на максимальное значение.



![Screenshot_5](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/ac1b56ae-8d78-4cd6-abfb-a2cad3620253)


Выполним тоже самое из папки .lxc. Убеждаемся в максимальном значении. Выходим из контейнера:

    exit
    
 Для того, что бы ограничить потребление памяти контейнером, необходимо добавить строку в файл конфигурации. Для начала считаем информацию из него и убедимся, что ограничений там нет командой:

    sudo cat /var/lib/lxc/testOne/config
    
 После этого добавляем в этот файл конфигурации вниз текста следующую строку:
 
    
    lxc.cgroup2.memory.max = 256M
    
    
![Screenshot_7 1](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/4d76c084-3118-4432-9cb2-b50e5f5535b5)


Таким образом мы ограничили потребление памяти на более 256 мб. Останавливаем контейнер и снова запускаем его. Вводим следующую команду, что бы убедиться, что ограничение работает:

    sudo cat /sys/fs/cgroup/lxc.payload.testOne/mempry.max




![Screenshot_8 1](https://github.com/vladislavkrutov8/Containerization-Seminar_2/assets/110223646/e93cce0c-8fa3-435b-9c0e-3fe156a7a2b7)


Как мы видим, система пересчитала и выдала результат, где много цифр. Не пугаемся, это значение примерно равно 256 мб.

Далее просмотрим список имеющихся в нашей системе контейнеров:

    sudo lxc-ls -f
    
    
У нас имеется один контейнер testOne, он запущен и в автозапуске стоит 0. Нам необходимо включить автозапуск, для этого октрываем файл конфигурации в редакторе nano:


    sudo nano /var/lib/lxc/testOne/config


Добавляем в конец текста файла конфигурации следующую строку:

    lxc.start.auto = 1


Сохраняем, закрываем редактор и перезагружаем систему, например командой '$ reboot'.
После перезагрузки снова выполняем команду:

    sudo lxc-ls -f
    
Вводим пароль root и убеждаемся, что контейнер запущен и автозапуск включен.












